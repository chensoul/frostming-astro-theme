---
import { themeConfig } from '../theme/config';
const onHome = Astro.url.pathname === '/';
---
<header class={onHome ? "flex flex-col items-center gap-4 py-8" : "sticky top-0 z-50 flex items-center justify-between border-b border-current bg-white py-4 dark:bg-black"}>
  <a href="/" class={onHome ? "" : "flex items-center gap-3 hover:opacity-70 transition-opacity"}>
    <img src="/avatar.svg" alt="Frost Ming" class={onHome ? "h-20 w-20 rounded-full" : "h-10 w-10 rounded-full"} fetchpriority="high" />
    {!onHome && <span class="text-lg font-medium">{themeConfig.siteName}</span>}
  </a>
  {onHome ? (
    <>
      <h1 class="font-serif text-3xl">{themeConfig.siteName}</h1>
      <div class="flex items-center gap-4">
        <>
          {themeConfig.socialHandles.twitter && (
            <a href={`https://twitter.com/${themeConfig.socialHandles.twitter}`} target="_blank" rel="noopener noreferrer" aria-label="twitter" class="hover:opacity-70 transition-opacity text-xl">
              <i class="fa-brands fa-x-twitter" aria-hidden="true"></i>
            </a>
          )}
          {themeConfig.socialHandles.github && (
            <a href={`https://github.com/${themeConfig.socialHandles.github}`} target="_blank" rel="noopener noreferrer" aria-label="github" class="hover:opacity-70 transition-opacity text-xl">
              <i class="fa-brands fa-github" aria-hidden="true"></i>
            </a>
          )}
          {themeConfig.socialHandles.telegram && (
            <a href={`https://t.me/${themeConfig.socialHandles.telegram}`} target="_blank" rel="noopener noreferrer" aria-label="telegram" class="hover:opacity-70 transition-opacity text-xl">
              <i class="fa-brands fa-telegram" aria-hidden="true"></i>
            </a>
          )}
          <a href="/feed.xml" aria-label="rss" class="hover:opacity-70 transition-opacity text-xl" title="RSS 订阅">
            <i class="fa-solid fa-rss" aria-hidden="true"></i>
          </a>
        </>
      </div>
    </>
  ) : null}
  <nav class="relative flex items-center gap-4 text-base">
    <input type="checkbox" id="menu-toggle" class="peer hidden" />
    <label for="menu-toggle" class="cursor-pointer hover:opacity-70 transition-opacity sm:hidden" aria-label="Toggle menu">
      <svg width="1em" height="1em" class="size-4" viewBox="0 0 24 24" aria-hidden="true"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="hidden sm:flex sm:items-center sm:gap-4">
      {onHome ? null : <a href="/" class="hover:opacity-70 transition-opacity">{themeConfig.homeLinkLabel}</a>}
      {themeConfig.navLinks.map((link) => (
        <a href={link.href} class="hover:opacity-70 transition-opacity">{link.label}</a>
      ))}
    </div>
    <button id="theme-toggle" aria-label="Toggle dark mode" class="cursor-pointer hover:opacity-70 transition-opacity">
      <svg width="1em" height="1em" class="size-4 hidden dark:block" viewBox="0 0 24 24" aria-hidden="true"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></g></svg>
      <svg width="1em" height="1em" class="size-4 block dark:hidden" viewBox="0 0 24 24" aria-hidden="true"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
    </button>
    <script>
      document.getElementById("theme-toggle")?.addEventListener("click", () => {
        const isDark = document.documentElement.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
    </script>
    <div class="peer-checked:flex hidden absolute top-full {onHome ? 'left-1/2 -translate-x-1/2' : 'right-0'} mt-3 flex-col items-{onHome ? 'center' : 'start'} gap-3 whitespace-nowrap rounded-lg border border-gray-200 bg-white p-3 shadow-lg dark:border-gray-800 dark:bg-black sm:hidden">
      {onHome ? null : <a href="/" class="hover:opacity-70 transition-opacity">{themeConfig.homeLinkLabel}</a>}
      {themeConfig.navLinks.map((link) => (
        <a href={link.href} class="hover:opacity-70 transition-opacity">{link.label}</a>
      ))}
    </div>
  </nav>
</header>
